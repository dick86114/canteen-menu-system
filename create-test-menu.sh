#!/bin/bash

# åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºæµ‹è¯•èœå•æ–‡ä»¶çš„è„šæœ¬

echo "ğŸ“ åˆ›å»ºæµ‹è¯•èœå•æ–‡ä»¶..."

# ç¡®ä¿menuç›®å½•å­˜åœ¨
mkdir -p ./menu

# åˆ›å»ºä¸€ä¸ªç®€å•çš„æµ‹è¯•Excelæ–‡ä»¶ï¼ˆCSVæ ¼å¼ï¼ŒExcelå¯ä»¥æ‰“å¼€ï¼‰
cat > ./menu/test-menu.csv << 'EOF'
æ—¥æœŸ,é¤æ¬¡,æ—¶é—´,èœå“åç§°,ä»·æ ¼
2025-12-14,æ—©é¤,07:00-09:00,å°ç¬¼åŒ…,8
2025-12-14,æ—©é¤,07:00-09:00,è±†æµ†,3
2025-12-14,åˆé¤,11:30-13:30,çº¢çƒ§è‚‰,15
2025-12-14,åˆé¤,11:30-13:30,ç±³é¥­,2
2025-12-14,æ™šé¤,17:30-19:30,å®«ä¿é¸¡ä¸,12
2025-12-14,æ™šé¤,17:30-19:30,ç±³é¥­,2
2025-12-15,æ—©é¤,07:00-09:00,ç…è›‹,6
2025-12-15,æ—©é¤,07:00-09:00,ç‰›å¥¶,4
2025-12-15,åˆé¤,11:30-13:30,ç³–é†‹æ’éª¨,18
2025-12-15,åˆé¤,11:30-13:30,ç±³é¥­,2
EOF

# è®¾ç½®æƒé™
chmod 644 ./menu/test-menu.csv

echo "âœ… æµ‹è¯•èœå•æ–‡ä»¶å·²åˆ›å»º: ./menu/test-menu.csv"
echo "ğŸ“‹ æ–‡ä»¶å†…å®¹:"
cat ./menu/test-menu.csv

echo ""
echo "ğŸ”„ é‡å¯å®¹å™¨ä»¥é‡æ–°æ‰«ææ–‡ä»¶..."
docker-compose -f compose.yaml restart

echo "â³ ç­‰å¾…å®¹å™¨å¯åŠ¨..."
sleep 10

echo "ğŸ§ª æµ‹è¯•åˆ·æ–°åŠŸèƒ½..."
curl -X POST http://localhost:1214/api/scanner/refresh